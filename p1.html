<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>월별 행사 달력</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #333;
        }
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .month-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .btn-primary {
            background-color: #1e88e5;
            color: white;
        }
        .btn-success {
            background-color: #4caf50;
            color: white;
        }
        .btn-secondary {
            background-color: #757575;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .search-bar {
            flex-grow: 1;
            max-width: 400px;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .calendar {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .calendar th {
            background-color: #f0f0f0;
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
            font-weight: bold;
        }
        .calendar th:first-child {
            color: #e57373; /* 일요일 */
        }
        .calendar th:last-child {
            color: #5c6bc0; /* 토요일 */
        }
        .calendar td {
            border: 1px solid #ddd;
            padding: 5px;
            height: 100px;
            vertical-align: top;
        }
        .calendar .date {
            font-weight: bold;
            margin-bottom: 8px;
            padding: 2px;
            text-align: center;
        }
        .calendar td:first-child .date {
            color: #e57373; /* 일요일 */
        }
        .calendar td:last-child .date {
            color: #5c6bc0; /* 토요일 */
        }
        .event {
            background-color: #e3f2fd;
            border-radius: 3px;
            padding: 6px 8px;
            margin-bottom: 6px;
            font-size: 0.9em;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            border-left: 3px solid #1976d2;
            transition: all 0.2s ease;
            display: block;
            text-align: center;
        }
        .event:hover {
            background-color: #bbdefb;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        /* 이벤트 유형별 색상 */
        .event-type-holiday {
            background-color: #ffcdd2;
            border-left-color: #e53935;
        }
        .event-type-meeting {
            background-color: #c8e6c9;
            border-left-color: #43a047;
        }
        .event-type-festival {
            background-color: #ffecb3;
            border-left-color: #ffb300;
        }
        .event-type-education {
            background-color: #b3e5fc;
            border-left-color: #039be5;
        }
        .more-events {
            background-color: #e0e0e0;
            border-left-color: #9e9e9e;
            text-align: center;
            font-size: 0.8em;
            color: #616161;
        }
        .event-list-item {
            transition: all 0.2s ease;
        }
        .event-list-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .today {
            background-color: #fffde7;
        }
        .other-month {
            background-color: #f9f9f9;
            color: #aaa;
        }
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            width: 80%;
            max-width: 600px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
        }
        .close-btn {
            cursor: pointer;
            font-size: 1.5em;
        }
        .modal-body {
            margin-bottom: 20px;
        }
        .modal-footer {
            text-align: right;
            border-top: 1px solid #eee;
            padding-top: 10px;
        }
        .event-detail {
            margin-bottom: 10px;
        }
        .event-detail strong {
            display: inline-block;
            width: 100px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>월별 행사 달력</h1>
        
        <div class="controls">
            <div class="month-selector">
                <select id="year-select">
                    <option value="2022">2022년</option>
                    <option value="2023">2023년</option>
                    <option value="2024">2024년</option>
                    <option value="2025" selected>2025년</option>
                </select>
                <select id="month-select">
                    <option value="1">1월</option>
                    <option value="2">2월</option>
                    <option value="3">3월</option>
                    <option value="4" selected>4월</option>
                    <option value="5">5월</option>
                    <option value="6">6월</option>
                    <option value="7">7월</option>
                    <option value="8">8월</option>
                    <option value="9">9월</option>
                    <option value="10">10월</option>
                    <option value="11">11월</option>
                    <option value="12">12월</option>
                </select>
                <button id="today-btn" class="btn btn-success">오늘</button>
            </div>
            
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="행사명, 장소, 유형 등으로 검색">
            </div>
            
            <button id="data-btn" class="btn btn-secondary">데이터 정보</button>
        </div>
        
        <div id="calendar-container">
            <table class="calendar" id="calendar">
                <thead>
                    <tr>
                        <th>일</th>
                        <th>월</th>
                        <th>화</th>
                        <th>수</th>
                        <th>목</th>
                        <th>금</th>
                        <th>토</th>
                    </tr>
                </thead>
                <tbody id="calendar-body">
                    <!-- Calendar will be populated here -->
                </tbody>
            </table>
        </div>
        
        <div class="filter-buttons">
            <button id="apply-filter" class="btn btn-success">적용</button>
            <button id="reset-filter" class="btn btn-primary">초기화</button>
        </div>
    </div>
    
    <!-- Event Details Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="event-title">행사 제목</h2>
                <span class="close-btn" id="close-modal">&times;</span>
            </div>
            <div class="modal-body" id="event-details">
                <!-- Event details will be populated here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="close-modal-btn">닫기</button>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let events = [];
            let filteredEvents = [];
            
            // Load CSV data
            fetch('p1.csv')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('CSV 파일을 불러올 수 없습니다.');
                    }
                    return response.text();
                })
                .then(data => {
                    // Parse CSV
                    const rows = data.split('\n');
                    
                    if (rows.length === 0) {
                        console.error('CSV 파일이 비어 있습니다.');
                        return;
                    }
                    
                    // p1.csv 열 인덱스 (0부터 시작)
                    const START_DATE_INDEX = 0;    // 시작날짜
                    const END_DATE_INDEX = 1;      // 종료날짜
                    const START_DAY_INDEX = 2;     // 시작요일
                    const END_DAY_INDEX = 3;       // 종료요일
                    const START_TIME_INDEX = 4;    // 시작시간
                    const END_TIME_INDEX = 5;      // 종료시간
                    const TITLE_INDEX = 6;         // 행사제목
                    const DESCRIPTION_INDEX = 7;   // 행사내용
                    const LOCATION_INDEX = 8;      // 장소
                    const TYPE_INDEX = 9;          // 유형
                    const TARGET_INDEX = 10;       // 대상
                    const ORGANIZATION_INDEX = 11; // 기관
                    const CONTACT_INDEX = 12;      // 연락처
                    const EXCEL_FORMAT_INDEX = 13; // 엑셀 파일 형식
                    const NOTES_INDEX = 14;        // 참고사항
                    
                    console.log("CSV 총 행 수:", rows.length);
                    
                    // 헤더 행 처리 (있다면)
                    let startRow = 0;
                    if (rows[0].includes('시작날짜') || rows[0].includes('행사제목')) {
                        startRow = 1;
                        console.log("헤더 감지됨:", rows[0]);
                    }
                    
                    // 데이터 행 처리
                    for (let i = startRow; i < rows.length; i++) {
                        const row = rows[i].trim();
                        if (row === '') continue;
                        
                        const values = parseCSVRow(row);
                        if (values.length <= TITLE_INDEX) {
                            console.warn(`행 ${i}의 데이터가 부족합니다: ${row}`);
                            continue;
                        }
                        
                        // 기본 필수 필드 확인
                        const startDateStr = values[START_DATE_INDEX]?.trim();
                        const titleStr = values[TITLE_INDEX]?.trim();
                        
                        if (!startDateStr || !titleStr) {
                            console.warn(`행 ${i}에 필수 필드(시작날짜 또는 행사제목)가 누락되었습니다.`);
                            continue;
                        }
                        
                        // 이벤트 객체 생성
                        const event = {
                            startDate: startDateStr,
                            title: titleStr,
                            endDate: values[END_DATE_INDEX]?.trim() || startDateStr, // 종료일이 없으면 시작일과 동일
                            startDay: values[START_DAY_INDEX]?.trim() || '',
                            endDay: values[END_DAY_INDEX]?.trim() || '',
                            startTime: values[START_TIME_INDEX]?.trim() || '',
                            endTime: values[END_TIME_INDEX]?.trim() || '',
                            description: values[DESCRIPTION_INDEX]?.trim() || titleStr, // 내용이 없으면 제목과 동일
                            location: values[LOCATION_INDEX]?.trim() || '',
                            type: values[TYPE_INDEX]?.trim() || '',
                            target: values[TARGET_INDEX]?.trim() || '',
                            organization: values[ORGANIZATION_INDEX]?.trim() || values[LOCATION_INDEX]?.trim() || '', // 기관이 없으면 장소와 동일
                            contact: values[CONTACT_INDEX]?.trim() || '',
                            excelFormat: values[EXCEL_FORMAT_INDEX]?.trim() || '',
                            notes: values[NOTES_INDEX]?.trim() || ''
                        };
                        
                        // 날짜 파싱 (YYYY-MM-DD 형식)
                        try {
                            event.date = new Date(event.startDate);
                            
                            // 날짜가 유효하지 않으면 다른 형식 시도
                            if (isNaN(event.date.getTime())) {
                                const dateParts = event.startDate.split('-');
                                if (dateParts.length === 3) {
                                    const year = parseInt(dateParts[0]);
                                    const month = parseInt(dateParts[1]) - 1; // 월은 0부터 시작
                                    const day = parseInt(dateParts[2]);
                                    event.date = new Date(year, month, day);
                                }
                            }
                            
                            // 여전히 유효하지 않으면 로그
                            if (isNaN(event.date.getTime())) {
                                console.warn(`행 ${i}의 날짜 '${event.startDate}'가 유효하지 않습니다.`);
                                continue; // 날짜가 유효하지 않으면 건너뛰기
                            }
                        } catch (e) {
                            console.error(`행 ${i}의 날짜 파싱 오류:`, e);
                            continue; // 오류 발생 시 건너뛰기
                        }
                        
                        // 이벤트 유형에 따른 클래스 추가
                        if (['공휴일', '휴일', '기념일'].includes(event.type)) {
                            event.className = 'event-type-holiday';
                        } else if (['회의', '미팅', '컨퍼런스'].includes(event.type)) {
                            event.className = 'event-type-meeting';
                        } else if (['축제', '페스티벌', '행사', '이벤트'].includes(event.type)) {
                            event.className = 'event-type-festival';
                        } else if (['교육', '강의', '세미나', '워크샵'].includes(event.type)) {
                            event.className = 'event-type-education';
                        }
                        
                        events.push(event);
                    }
                    
                    filteredEvents = [...events];
                    
                    console.log(`총 ${events.length}개 이벤트 로드 완료`);
                    
                    // Initialize calendar with current month
                    const today = new Date();
                    document.getElementById('year-select').value = today.getFullYear();
                    document.getElementById('month-select').value = today.getMonth() + 1;
                    generateCalendar(today.getFullYear(), today.getMonth() + 1);
                    
                    // CSV 파일 정보 표시
                    const container = document.querySelector('.container');
                    const statsDiv = document.createElement('div');
                    statsDiv.style.marginTop = '20px';
                    statsDiv.style.padding = '10px';
                    statsDiv.style.backgroundColor = '#f0f0f0';
                    statsDiv.style.borderRadius = '5px';
                    statsDiv.innerHTML = `<p>CSV 파일 통계: 총 ${rows.length}행 중 ${events.length}개 이벤트 로드됨</p>`;
                    container.appendChild(statsDiv);
                })
                .catch(error => {
                    console.error('CSV 파일 로드 오류:', error);
                    alert('CSV 파일을 불러오는 중 오류가 발생했습니다. 파일 경로를 확인해주세요.');
                });
            
            // Generate calendar for given year and month
            function generateCalendar(year, month) {
                console.log(`${year}년 ${month}월 달력 생성`);
                
                const firstDay = new Date(year, month - 1, 1);
                const lastDay = new Date(year, month, 0);
                const daysInMonth = lastDay.getDate();
                const startingDayOfWeek = firstDay.getDay();
                
                const calendarBody = document.getElementById('calendar-body');
                calendarBody.innerHTML = '';
                
                let date = 1;
                for (let i = 0; i < 6; i++) {
                    if (date > daysInMonth) break;
                    
                    const row = document.createElement('tr');
                    
                    for (let j = 0; j < 7; j++) {
                        const cell = document.createElement('td');
                        
                        if (i === 0 && j < startingDayOfWeek) {
                            // 이전 달의 날짜 (빈 칸)
                            cell.classList.add('other-month');
                            const prevMonthLastDay = new Date(year, month - 1, 0).getDate();
                            const prevDate = prevMonthLastDay - (startingDayOfWeek - j - 1);
                            
                            const dateDiv = document.createElement('div');
                            dateDiv.classList.add('date');
                            dateDiv.textContent = prevDate;
                            cell.appendChild(dateDiv);
                            
                        } else if (date > daysInMonth) {
                            // 다음 달의 날짜 (빈 칸)
                            cell.classList.add('other-month');
                            const nextDate = date - daysInMonth;
                            
                            const dateDiv = document.createElement('div');
                            dateDiv.classList.add('date');
                            dateDiv.textContent = nextDate;
                            cell.appendChild(dateDiv);
                            
                            date++;
                        } else {
                            // 현재 달의 날짜
                            const dateDiv = document.createElement('div');
                            dateDiv.classList.add('date');
                            dateDiv.textContent = date;
                            cell.appendChild(dateDiv);
                            
                            // 오늘 날짜인지 확인
                            const today = new Date();
                            if (date === today.getDate() && month === today.getMonth() + 1 && year === today.getFullYear()) {
                                cell.classList.add('today');
                            }
                            
                            // 해당 날짜의 이벤트 추가
                            const currentDate = new Date(year, month - 1, date);
                            let eventsForDay = [];
                            
                            // 해당 날짜의 이벤트 찾기
                            filteredEvents.forEach(event => {
                                if (!event.date) return;
                                
                                // 날짜 비교 (년, 월, 일만 비교)
                                if (event.date.getDate() === currentDate.getDate() && 
                                    event.date.getMonth() === currentDate.getMonth() && 
                                    event.date.getFullYear() === currentDate.getFullYear()) {
                                    eventsForDay.push(event);
                                }
                            });
                            
                            // 이벤트가 있으면 추가
                            if (eventsForDay.length > 0) {
                                console.log(`${year}-${month}-${date}에 ${eventsForDay.length}개 이벤트 있음:`, 
                                    eventsForDay.map(e => e.title).join(', '));
                                
                                // 최대 3개까지만 표시하고 나머지는 +N개 형태로 표시
                                const maxDisplay = 3;
                                const displayEvents = eventsForDay.slice(0, maxDisplay);
                                
                                displayEvents.forEach(event => {
                                    const eventDiv = document.createElement('div');
                                    eventDiv.classList.add('event');
                                    if (event.className) {
                                        eventDiv.classList.add(event.className);
                                    }
                                    eventDiv.textContent = event.title;
                                    
                                    eventDiv.addEventListener('click', function(e) {
                                        e.preventDefault();
                                        e.stopPropagation();
                                        showEventDetails(event);
                                    });
                                    
                                    cell.appendChild(eventDiv);
                                });
                                
                                // 더 많은 이벤트가 있으면 +N개 표시
                                if (eventsForDay.length > maxDisplay) {
                                    const moreDiv = document.createElement('div');
                                    moreDiv.classList.add('event');
                                    moreDiv.classList.add('more-events');
                                    moreDiv.textContent = `+${eventsForDay.length - maxDisplay}개 더`;
                                    
                                    moreDiv.addEventListener('click', function(e) {
                                        e.preventDefault();
                                        e.stopPropagation();
                                        showEventsForDay(eventsForDay, currentDate);
                                    });
                                    
                                    cell.appendChild(moreDiv);
                                }
                            }
                            
                            date++;
                        }
                        
                        row.appendChild(cell);
                    }
                    
                    calendarBody.appendChild(row);
                }
            }
            
            // Show event details in modal
            function showEventDetails(event) {
                document.getElementById('event-title').textContent = event.title || '제목 없음';
                
                const detailsContainer = document.getElementById('event-details');
                detailsContainer.innerHTML = '';
                
                // 세부 정보 표시 순서 정의
                const fieldOrder = [
                    {key: 'startDate', label: '시작날짜'},
                    {key: 'endDate', label: '종료날짜', condition: event => event.endDate !== event.startDate},
                    {key: 'startDay', label: '요일'},
                    {key: 'startTime', label: '시작시간'},
                    {key: 'endTime', label: '종료시간', condition: event => event.endTime !== event.startTime},
                    {key: 'location', label: '장소'},
                    {key: 'description', label: '행사내용', condition: event => event.description !== event.title},
                    {key: 'type', label: '유형'},
                    {key: 'target', label: '대상'},
                    {key: 'organization', label: '기관', condition: event => event.organization !== event.location},
                    {key: 'contact', label: '연락처'},
                    {key: 'notes', label: '참고사항'}
                ];
                
                // 필드 순서대로 세부 정보 추가
                fieldOrder.forEach(field => {
                    if (!event[field.key]) return; // 값이 없으면 표시하지 않음
                    
                    // 조건이 있고, 조건이 false면 표시하지 않음
                    if (field.condition && !field.condition(event)) return;
                    
                    const detailDiv = document.createElement('div');
                    detailDiv.classList.add('event-detail');
                    detailDiv.innerHTML = `<strong>${field.label}:</strong> ${event[field.key]}`;
                    detailsContainer.appendChild(detailDiv);
                });
                
                document.getElementById('event-modal').style.display = 'block';
            }
            
            // 특정 날짜의 모든 이벤트 표시
            function showEventsForDay(events, date) {
                document.getElementById('event-title').textContent = `${date.getFullYear()}년 ${date.getMonth()+1}월 ${date.getDate()}일 행사 목록`;
                
                const detailsContainer = document.getElementById('event-details');
                detailsContainer.innerHTML = '';
                
                events.forEach((event, index) => {
                    const eventDiv = document.createElement('div');
                    eventDiv.classList.add('event-list-item');
                    eventDiv.style.padding = '10px';
                    eventDiv.style.marginBottom = '10px';
                    eventDiv.style.borderLeft = '3px solid #1976d2';
                    eventDiv.style.backgroundColor = '#f5f5f5';
                    eventDiv.style.borderRadius = '3px';
                    
                    // 이벤트 유형에 따른 스타일 적용
                    if (event.className) {
                        if (event.className === 'event-type-holiday') {
                            eventDiv.style.borderLeftColor = '#e53935';
                        } else if (event.className === 'event-type-meeting') {
                            eventDiv.style.borderLeftColor = '#43a047';
                        } else if (event.className === 'event-type-festival') {
                            eventDiv.style.borderLeftColor = '#ffb300';
                        } else if (event.className === 'event-type-education') {
                            eventDiv.style.borderLeftColor = '#039be5';
                        }
                    }
                    
                    // 이벤트 제목
                    const titleDiv = document.createElement('div');
                    titleDiv.style.fontWeight = 'bold';
                    titleDiv.style.fontSize = '1.1em';
                    titleDiv.style.marginBottom = '5px';
                    titleDiv.textContent = event.title;
                    eventDiv.appendChild(titleDiv);
                    
                    // 이벤트 시간 및 장소
                    const infoDiv = document.createElement('div');
                    infoDiv.style.fontSize = '0.9em';
                    infoDiv.style.color = '#555';
                    
                    let infoText = '';
                    if (event.startTime) {
                        infoText += `${event.startTime}`;
                        if (event.endTime && event.endTime !== event.startTime) {
                            infoText += ` ~ ${event.endTime}`;
                        }
                    }
                    
                    if (event.location) {
                        if (infoText) infoText += ' | ';
                        infoText += event.location;
                    }
                    
                    infoDiv.textContent = infoText;
                    eventDiv.appendChild(infoDiv);
                    
                    // 클릭 시 이벤트 상세 정보 표시
                    eventDiv.style.cursor = 'pointer';
                    eventDiv.addEventListener('click', function() {
                        showEventDetails(event);
                    });
                    
                    detailsContainer.appendChild(eventDiv);
                });
                
                document.getElementById('event-modal').style.display = 'block';
            }
            
            // Parse CSV row handling quoted fields and commas within fields
            function parseCSVRow(row) {
                const result = [];
                let insideQuotes = false;
                let currentValue = '';
                
                for (let i = 0; i < row.length; i++) {
                    const char = row[i];
                    
                    if (char === '"') {
                        insideQuotes = !insideQuotes;
                    } else if (char === ',' && !insideQuotes) {
                        result.push(currentValue);
                        currentValue = '';
                    } else {
                        currentValue += char;
                    }
                }
                
                result.push(currentValue);
                return result;
            }
            
        // Update calendar when month or year selection changes
            document.getElementById('month-select').addEventListener('change', updateCurrentMonth);
            document.getElementById('year-select').addEventListener('change', updateCurrentMonth);
            
            function updateCurrentMonth() {
                const year = parseInt(document.getElementById('year-select').value);
                const month = parseInt(document.getElementById('month-select').value);
                generateCalendar(year, month);
            }
            
            // Set to today
            document.getElementById('today-btn').addEventListener('click', function() {
                const today = new Date();
                document.getElementById('year-select').value = today.getFullYear();
                document.getElementById('month-select').value = today.getMonth() + 1;
                generateCalendar(today.getFullYear(), today.getMonth() + 1);
            });
            
            // Search functionality
            document.getElementById('search-input').addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                if (searchTerm === '') {
                    filteredEvents = [...events];
                } else {
                    filteredEvents = events.filter(event => {
                        // 모든 필드에서 검색어 찾기
                        for (const key in event) {
                            if (typeof event[key] === 'string' && 
                                event[key].toLowerCase().includes(searchTerm)) {
                                return true;
                            }
                        }
                        return false;
                    });
                }
                
                updateCurrentMonth();
            });
            
            // Apply and reset filters
            document.getElementById('apply-filter').addEventListener('click', function() {
                const searchTerm = document.getElementById('search-input').value.toLowerCase();
                
                if (searchTerm === '') {
                    filteredEvents = [...events];
                } else {
                    filteredEvents = events.filter(event => {
                        for (const key in event) {
                            if (typeof event[key] === 'string' && 
                                event[key].toLowerCase().includes(searchTerm)) {
                                return true;
                            }
                        }
                        return false;
                    });
                }
                
                updateCurrentMonth();
            });
            
            document.getElementById('reset-filter').addEventListener('click', function() {
                document.getElementById('search-input').value = '';
                filteredEvents = [...events];
                updateCurrentMonth();
            });
            
            // 데이터 정보 버튼
            document.getElementById('data-btn').addEventListener('click', function() {
                alert(`CSV 파일 정보:\n- 총 ${events.length}개의 이벤트가 로드되었습니다.\n- 파일 경로: p1.csv\n- 필수 필드: 시작날짜, 행사제목`);
            });
            
            // Close modal when clicking the close button
            document.getElementById('close-modal').addEventListener('click', function() {
                document.getElementById('event-modal').style.display = 'none';
            });
            
            document.getElementById('close-modal-btn').addEventListener('click', function() {
                document.getElementById('event-modal').style.display = 'none';
            });
            
            // Close modal when clicking outside of it
            window.addEventListener('click', function(event) {
                const modal = document.getElementById('event-modal');
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>